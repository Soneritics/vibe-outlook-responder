"use strict";(self.webpackChunkoutlook_ai_assistant=self.webpackChunkoutlook_ai_assistant||[]).push([[14],{9014(e,n,s){s.a(e,async(e,i)=>{try{s.d(n,{GenerationPanel:()=>v});var a=s(4848),t=s(6540),r=s(6117),c=s(9437),l=s(8610),o=s(6922),d=s(4541),p=s(2558),g=s(9059),u=s(6394),h=s(444),x=s(2784),j=s(269),y=e([h]),m=y.then?(await y)():y;h=m[0];const f=(0,d.n)({container:{padding:p.L.spacingVerticalL,display:"flex",flexDirection:"column",gap:p.L.spacingVerticalM},loading:{display:"flex",alignItems:"center",gap:p.L.spacingHorizontalM}}),v=({promptId:e})=>{const n=f(),[s,i]=(0,t.useState)(null),[d,p]=(0,t.useState)(!0),{settings:y,isLoading:m}=(0,x.t)(),{prompts:v,loading:k}=(0,j.F)(),{isGenerating:w,currentStep:L,error:N,generate:P,cancel:E}=(0,h.A)();(0,t.useEffect)(()=>{if(!k&&v.length>0){const n=v.find(n=>n.id===e);n?(i(n),p(!1),y?.apiKey&&!m&&I(n)):p(!1)}},[e,v,k,y,m]);const I=async e=>{y?.apiKey&&await P(e.content,y.apiKey,y.selectedModel||"gpt-4")};return d||m||k?(0,a.jsx)("div",{className:n.container,children:(0,a.jsxs)("div",{className:n.loading,children:[(0,a.jsx)(r.y,{size:"small"}),(0,a.jsx)(c.E,{children:"Loading..."})]})}):s?y?.apiKey?(0,a.jsxs)("div",{className:n.container,children:[N&&(0,a.jsx)(u.F,{message:N,onRetry:()=>I(s),onDismiss:()=>window.close()}),(0,a.jsx)(g.v,{isOpen:w||null!==N,currentStep:L,onCancel:E,error:N||void 0}),!w&&!N&&(0,a.jsx)(l.n,{intent:"success",children:(0,a.jsx)(o.R,{children:(0,a.jsx)(c.E,{children:"AI response generated successfully! You can now edit or send your email."})})})]}):(0,a.jsx)("div",{className:n.container,children:(0,a.jsx)(l.n,{intent:"warning",children:(0,a.jsx)(o.R,{children:(0,a.jsx)(c.E,{children:"No API key configured. Please configure your API key in settings before generating responses."})})})}):(0,a.jsx)("div",{className:n.container,children:(0,a.jsx)(l.n,{intent:"error",children:(0,a.jsx)(o.R,{children:(0,a.jsx)(c.E,{children:"Prompt not found. Please select a valid prompt."})})})})};i()}catch(e){i(e)}})}}]);