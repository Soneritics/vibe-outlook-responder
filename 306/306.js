"use strict";(self.webpackChunkoutlook_ai_assistant=self.webpackChunkoutlook_ai_assistant||[]).push([[306],{5951(e,t,r){r.d(t,{T:()=>g});var n=r(4848),o=r(403),s=r(1439),a=r(4938),i=r(8130),c=r(9265),l=r(7395),d=r(9563),p=r(813);const g=({open:e,title:t,message:r,confirmLabel:g="Confirm",cancelLabel:m="Cancel",onConfirm:u,onCancel:h,destructive:y=!1})=>(0,n.jsx)(o.l,{open:e,onOpenChange:(e,t)=>!t.open&&h(),children:(0,n.jsx)(s.E,{children:(0,n.jsxs)(a.R,{children:[(0,n.jsx)(i.L,{children:t}),(0,n.jsx)(c.C,{children:r}),(0,n.jsxs)(l.i,{children:[(0,n.jsx)(d.z,{disableButtonEnhancement:!0,children:(0,n.jsx)(p.$,{appearance:"secondary",onClick:h,children:m})}),(0,n.jsx)(p.$,{appearance:"primary",onClick:u,children:g})]})]})})})},9306(e,t,r){r.d(t,{SettingsPanel:()=>N});var n=r(4848),o=r(6540),s=r(4541),a=r(2558),i=r(6117),c=r(6516),l=r(9437),d=r(9105),p=r(813),g=r(8490),m=r(8551),u=r(3616),h=r(2471),y=r(2534);const S=(0,s.n)({container:{display:"flex",flexDirection:"column",gap:a.L.spacingVerticalS},inputWrapper:{display:"flex",gap:a.L.spacingHorizontalS,alignItems:"flex-start"},input:{flexGrow:1},buttonGroup:{display:"flex",gap:a.L.spacingHorizontalXS},successMessage:{color:a.L.colorPaletteGreenForeground1,fontSize:a.L.fontSizeBase200},errorMessage:{color:a.L.colorPaletteRedForeground1,fontSize:a.L.fontSizeBase200}}),f=({value:e,onChange:t,onTestConnection:r,error:s,isTestingConnection:a=!1,testConnectionResult:c})=>{const l=S(),[d,g]=(0,o.useState)(!1),m=!e||0===e.trim().length;return(0,n.jsxs)("div",{className:l.container,children:[(0,n.jsx)(u.D,{label:"API Key",validationMessage:s,validationState:s?"error":void 0,children:(0,n.jsxs)("div",{className:l.inputWrapper,children:[(0,n.jsx)(h.p,{type:d?"text":"password",value:e,onChange:e=>{t(e.target.value)},placeholder:"sk-...",className:l.input,"aria-label":"API Key","aria-invalid":!!s}),(0,n.jsxs)("div",{className:l.buttonGroup,children:[(0,n.jsx)(p.$,{appearance:"subtle",icon:d?(0,n.jsx)(y.nat,{}):(0,n.jsx)(y.umr,{}),onClick:()=>{g(!d)},"aria-label":d?"Hide API key":"Show API key",title:d?"Hide":"Show"}),(0,n.jsx)(p.$,{appearance:"primary",onClick:r,disabled:m||a,"aria-label":"Test Connection",children:a?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.y,{size:"tiny"})," Testing..."]}):"Test Connection"})]})]})}),c&&(0,n.jsx)("div",{className:c.success?l.successMessage:l.errorMessage,role:"alert",children:c.message})]})};var x=r(4429),v=r(3879);const E=(0,s.n)({container:{display:"flex",flexDirection:"column",gap:a.L.spacingVerticalXS},description:{fontSize:a.L.fontSizeBase200,color:a.L.colorNeutralForeground2,marginTop:a.L.spacingVerticalXXS},optionContent:{display:"flex",flexDirection:"column",gap:a.L.spacingVerticalXXS},optionTitle:{fontWeight:a.L.fontWeightSemibold},optionDescription:{fontSize:a.L.fontSizeBase200,color:a.L.colorNeutralForeground2}}),w=[{id:"gpt-5.2",name:"GPT-5.2 (Default)",description:"Most advanced model with superior reasoning",contextWindow:"256K tokens"},{id:"gpt-5-mini",name:"GPT-5 Mini",description:"Balanced performance and speed",contextWindow:"128K tokens"},{id:"gpt-5-nano",name:"GPT-5 Nano",description:"Ultra-fast responses for simple tasks",contextWindow:"64K tokens"},{id:"gpt-4o",name:"GPT-4o",description:"Previous flagship with enhanced reasoning",contextWindow:"128K tokens"},{id:"gpt-4-turbo",name:"GPT-4 Turbo",description:"Faster and more affordable with excellent performance",contextWindow:"128K tokens"},{id:"gpt-4",name:"GPT-4",description:"High-quality responses with strong reasoning",contextWindow:"8K tokens"},{id:"gpt-3.5-turbo",name:"GPT-3.5 Turbo",description:"Fast and cost-effective for simpler tasks",contextWindow:"16K tokens"}],T=({value:e,onChange:t,disabled:r=!1})=>{const o=E(),s=e||"gpt-5.2",a=w.find(e=>e.id===s);return(0,n.jsxs)("div",{className:o.container,children:[(0,n.jsx)(u.D,{label:"Model",children:(0,n.jsx)(x.m,{value:a?.name||"",selectedOptions:[s],onOptionSelect:(e,r)=>{r.optionValue&&t(r.optionValue)},disabled:r,"aria-label":"Select ChatGPT model",children:w.map(e=>(0,n.jsx)(v.c,{value:e.id,text:e.name,children:(0,n.jsxs)("div",{className:o.optionContent,children:[(0,n.jsx)(l.E,{className:o.optionTitle,children:e.name}),(0,n.jsxs)(l.E,{className:o.optionDescription,children:[e.description," • ",e.contextWindow]})]})},e.id))})}),a&&(0,n.jsxs)(l.E,{className:o.description,children:[a.description," • Context: ",a.contextWindow]})]})};var b=r(2889),A=r(7575),L=r(5399),j=r(8005),C=r(4826),P=r(6014);const k=(0,s.n)({container:{display:"flex",flexDirection:"column",gap:a.L.spacingVerticalM},card:{padding:a.L.spacingHorizontalM},buttonGroup:{display:"flex",gap:a.L.spacingHorizontalS,marginTop:a.L.spacingVerticalM},message:{display:"flex",alignItems:"center",gap:a.L.spacingHorizontalS,marginTop:a.L.spacingVerticalS},successMessage:{color:a.L.colorPaletteGreenForeground1},errorMessage:{color:a.L.colorPaletteRedForeground1},description:{color:a.L.colorNeutralForeground3,marginBottom:a.L.spacingVerticalS}}),I=({prompts:e,onImport:t})=>{const r=k(),[s,a]=(0,o.useState)(null),[i,c]=(0,o.useState)(!1),[d,g]=(0,o.useState)(!1);return(0,n.jsxs)("div",{className:r.container,children:[(0,n.jsx)(b.J,{size:"large",children:"Export/Import Prompts"}),(0,n.jsx)(l.E,{className:r.description,children:"Backup your prompts by exporting to clipboard, or restore from a previous export."}),(0,n.jsxs)(A.Z,{className:r.card,children:[(0,n.jsx)(L.a,{header:(0,n.jsx)(l.E,{weight:"semibold",children:"Backup & Restore"}),description:(0,n.jsx)(l.E,{size:200,children:"Prompts are saved as JSON format. Import will merge with existing prompts."})}),(0,n.jsxs)("div",{className:r.buttonGroup,children:[(0,n.jsx)(p.$,{appearance:"secondary",icon:(0,n.jsx)(j.W1u,{}),onClick:async()=>{c(!0),a(null);try{const t=JSON.stringify(e,null,2);await async function(e){try{if(void 0!==navigator.clipboard&&void 0!==navigator.clipboard.writeText)await navigator.clipboard.writeText(e);else{const t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.left="-999999px",document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}}catch(e){throw new Error("Failed to copy to clipboard")}}(t),a({type:"success",text:`Successfully exported ${e.length} prompt(s) to clipboard`})}catch(e){a({type:"error",text:`Export failed: ${e instanceof Error?e.message:"Unknown error"}`})}finally{c(!1),setTimeout(()=>a(null),5e3)}},disabled:i||0===e.length,children:i?"Exporting...":"Export to Clipboard"}),(0,n.jsx)(p.$,{appearance:"secondary",icon:(0,n.jsx)(j.Do$,{}),onClick:async()=>{g(!0),a(null);try{const r=await async function(){try{if(void 0!==navigator.clipboard&&void 0!==navigator.clipboard.readText)return await navigator.clipboard.readText();throw new Error("Clipboard API not available in this browser")}catch(e){throw new Error("Failed to read from clipboard")}}();if(!r)return void a({type:"error",text:"Clipboard is empty. Please copy valid JSON first."});let n;try{n=JSON.parse(r)}catch(e){return void a({type:"error",text:"Invalid JSON format. Please check clipboard content."})}if(!Array.isArray(n))return void a({type:"error",text:"Invalid format: Expected an array of prompts."});if(!n.every(e=>e&&"string"==typeof e.title&&"string"==typeof e.content))return void a({type:"error",text:"Invalid prompt structure. Each prompt must have title and content."});const o=new Set(e.map(e=>e.title.toLowerCase())),s=n.map(e=>{let t=e.title;if(o.has(t.toLowerCase())){t=`${t} (imported)`;let r=1;for(;o.has(t.toLowerCase());)t=`${e.title} (imported ${r})`,r++}return{...e,title:t,id:`${Date.now()}_${Math.random().toString(36).substring(2,9)}`,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()}});await t(s),a({type:"success",text:`Successfully imported ${s.length} prompt(s)`})}catch(e){a({type:"error",text:`Import failed: ${e instanceof Error?e.message:"Unknown error"}`})}finally{g(!1),setTimeout(()=>a(null),5e3)}},disabled:d,children:d?"Importing...":"Import from Clipboard"})]}),s&&(0,n.jsxs)("div",{className:`${r.message} ${"success"===s.type?r.successMessage:r.errorMessage}`,role:"alert",children:["success"===s.type?(0,n.jsx)(C.kt0,{}):(0,n.jsx)(P.Pe6,{}),(0,n.jsx)(l.E,{children:s.text})]})]}),(0,n.jsx)(l.E,{size:200,className:r.description,children:'Note: Exported prompts include all content and metadata. Import will preserve your existing prompts and append any duplicates with "(imported)".'})]})};var K=r(2784),D=r(269);const F='API key must start with "sk-" and be at least 20 characters';function O(e){return e&&0!==e.trim().length?e.startsWith("sk-")?e.length<20?{isValid:!1,error:F}:{isValid:!0}:{isValid:!1,error:F}:{isValid:!1,error:"API key is required"}}var _=r(5951);const R=(0,s.n)({container:{display:"flex",flexDirection:"column",gap:a.L.spacingVerticalL,padding:a.L.spacingHorizontalL,height:"100%",overflow:"auto"},header:{display:"flex",flexDirection:"column",gap:a.L.spacingVerticalXS},section:{display:"flex",flexDirection:"column",gap:a.L.spacingVerticalM},buttonGroup:{display:"flex",gap:a.L.spacingHorizontalS,marginTop:a.L.spacingVerticalM},errorMessage:{color:a.L.colorPaletteRedForeground1,fontSize:a.L.fontSizeBase200},successMessage:{color:a.L.colorPaletteGreenForeground1,fontSize:a.L.fontSizeBase200},loadingContainer:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},dangerZone:{marginTop:a.L.spacingVerticalL,paddingTop:a.L.spacingVerticalL}}),N=()=>{const e=R(),{settings:t,isLoading:r,updateSettings:s,resetSettings:u}=(0,K.t)(),{prompts:h,createPrompt:y,deletePrompt:S}=(0,D.F)(),[x,v]=(0,o.useState)(""),[E,w]=(0,o.useState)(""),[b,A]=(0,o.useState)(""),[L,j]=(0,o.useState)(!1),[C,P]=(0,o.useState)(void 0),[k,F]=(0,o.useState)(!1),[N,G]=(0,o.useState)(""),[M,$]=(0,o.useState)(!1);o.useEffect(()=>{r||(v(t.apiKey),w(t.selectedModel))},[t,r]);const z=(0,o.useCallback)(async()=>{j(!0),P(void 0),A("");try{const e=O(x);if(!e.isValid)return A(e.error||"Invalid API key format"),void P({success:!1,message:'Invalid API key format. Must start with "sk-"'});const t=await fetch("https://api.openai.com/v1/models",{method:"GET",headers:{Authorization:`Bearer ${x}`}});t.ok?P({success:!0,message:"Connection successful! Your API key is valid."}):401===t.status?P({success:!1,message:"Invalid or expired API key. Please check your key."}):P({success:!1,message:`Connection failed with status ${t.status}. Please try again.`})}catch(e){P({success:!1,message:"Network error. Please check your connection and try again."})}finally{j(!1)}},[x]);return r?(0,n.jsx)("div",{className:e.loadingContainer,children:(0,n.jsx)(i.y,{size:"large",label:"Loading settings..."})}):(0,n.jsxs)("div",{className:e.container,children:[(0,n.jsxs)("div",{className:e.header,children:[(0,n.jsx)(c.M,{children:"Settings"}),(0,n.jsx)(l.E,{children:"Configure your ChatGPT API key and model preferences"})]}),(0,n.jsx)(d.c,{}),(0,n.jsxs)("div",{className:e.section,children:[(0,n.jsx)(f,{value:x,onChange:e=>{v(e),A(""),P(void 0),G("")},onTestConnection:z,error:b,isTestingConnection:L,testConnectionResult:C}),(0,n.jsx)(T,{value:E,onChange:e=>{w(e),G("")},disabled:k})]}),(0,n.jsx)(d.c,{}),(0,n.jsx)("div",{className:e.section,children:(0,n.jsx)(I,{prompts:h,onImport:async e=>{try{for(const t of e)await y({title:t.title,content:t.content})}catch(e){throw new Error("Failed to import prompts")}}})}),(0,n.jsx)("div",{className:e.buttonGroup,children:(0,n.jsx)(p.$,{appearance:"primary",icon:(0,n.jsx)(g.osE,{}),onClick:async()=>{F(!0),G(""),A("");try{if(x.trim()){const e=O(x);if(!e.isValid)return A(e.error||"Invalid API key format"),void F(!1)}await s({apiKey:x,selectedModel:E}),G("Settings saved successfully!"),setTimeout(()=>G(""),3e3)}catch(e){G("Failed to save settings. Please try again.")}finally{F(!1)}},disabled:k,children:k?"Saving...":"Save Settings"})}),N&&(0,n.jsx)(l.E,{className:N.includes("success")?e.successMessage:e.errorMessage,role:"alert",children:N}),(0,n.jsxs)("div",{className:e.dangerZone,children:[(0,n.jsx)(d.c,{}),(0,n.jsx)(c.M,{children:"Danger Zone"}),(0,n.jsx)(l.E,{children:"Reset all settings and delete all prompts. This action cannot be undone."}),(0,n.jsx)(p.$,{appearance:"subtle",icon:(0,n.jsx)(m.aYy,{}),onClick:()=>$(!0),style:{marginTop:a.L.spacingVerticalS},children:"Reset All Data"})]}),(0,n.jsx)(_.T,{open:M,title:"Reset All Data?",message:"This will clear your API key, model preference, all prompts, and all other settings. This action cannot be undone.",confirmLabel:"Reset",cancelLabel:"Cancel",onConfirm:async()=>{try{await u();for(const e of h)await S(e.id);v(""),w("gpt-5.2"),A(""),P(void 0),G("All settings and prompts have been reset."),$(!1)}catch(e){G("Failed to reset settings. Please try again.")}},onCancel:()=>$(!1)})]})}},2784(e,t,r){r.d(t,{t:()=>m});var n=r(6540);const o="outlook-addin-v1",s="AES-GCM",a="enc:";function i(){return"undefined"!=typeof crypto&&void 0!==crypto.subtle&&"function"==typeof crypto.subtle.importKey}function c(){try{if("undefined"!=typeof Office&&Office.context?.mailbox?.userProfile?.emailAddress)return Office.context.mailbox.userProfile.emailAddress}catch{}return"local-development-user"}async function l(e){const t=new TextEncoder,r=await crypto.subtle.importKey("raw",t.encode(e+o),"PBKDF2",!1,["deriveKey"]);return crypto.subtle.deriveKey({name:"PBKDF2",salt:t.encode(o),iterations:1e5,hash:"SHA-256"},r,{name:s,length:256},!1,["encrypt","decrypt"])}const d="outlook_addin_roaming_";function p(){return"undefined"!=typeof Office&&void 0!==Office.context&&void 0!==Office.context.roamingSettings}class g{STORAGE_KEYS={API_KEY:"settings_apiKey",SELECTED_MODEL:"settings_selectedModel",LAST_UPDATED:"settings_lastUpdated"};DEFAULT_SETTINGS={apiKey:"",selectedModel:"gpt-5.2",lastUpdated:(new Date).toISOString()};async getSettings(){try{const e=await this.getApiKey();return{apiKey:e,selectedModel:this.getFromRoamingSettings(this.STORAGE_KEYS.SELECTED_MODEL)||this.DEFAULT_SETTINGS.selectedModel,lastUpdated:this.getFromRoamingSettings(this.STORAGE_KEYS.LAST_UPDATED)||this.DEFAULT_SETTINGS.lastUpdated}}catch(e){return console.error("Error loading settings:",e),{...this.DEFAULT_SETTINGS}}}async getApiKey(){try{const t=this.getFromRoamingSettings(this.STORAGE_KEYS.API_KEY);if(!t){const e=this.getFromLocalStorage(this.STORAGE_KEYS.API_KEY);return e?(await this.saveApiKey(e),this.removeFromLocalStorage(this.STORAGE_KEYS.API_KEY),e):""}return e=t,e?.startsWith(a)?await async function(e){if(!e.startsWith(a))return e;const t=e.slice(4);if(!i())return atob(t);try{const e=c(),r=await l(e),n=Uint8Array.from(atob(t),e=>e.charCodeAt(0)),o=n.slice(0,12),a=n.slice(12),i=await crypto.subtle.decrypt({name:s,iv:o},r,a);return(new TextDecoder).decode(i)}catch(e){throw console.error("Decryption error:",e),new Error("Failed to decrypt data")}}(t):t}catch(e){return console.error("Error retrieving API key:",e),""}var e}async saveApiKey(e){if(!e)return void this.removeFromRoamingSettings(this.STORAGE_KEYS.API_KEY);const t=await async function(e){if(!i())return a+btoa(e);try{const t=c(),r=await l(t),n=new TextEncoder,o=crypto.getRandomValues(new Uint8Array(12)),i=await crypto.subtle.encrypt({name:s,iv:o},r,n.encode(e)),d=new Uint8Array(o.length+i.byteLength);return d.set(o),d.set(new Uint8Array(i),o.length),a+btoa(String.fromCharCode(...d))}catch(e){throw console.error("Encryption error:",e),new Error("Failed to encrypt data")}}(e);this.saveToRoamingSettings(this.STORAGE_KEYS.API_KEY,t)}async saveSettings(e){try{await this.saveApiKey(e.apiKey),this.saveToRoamingSettings(this.STORAGE_KEYS.SELECTED_MODEL,e.selectedModel);const t=(new Date).toISOString();this.saveToRoamingSettings(this.STORAGE_KEYS.LAST_UPDATED,t),await this.saveRoamingSettingsAsync()}catch(e){throw console.error("Error saving settings:",e),new Error("Failed to save settings")}}async clearSettings(){try{this.removeFromRoamingSettings(this.STORAGE_KEYS.API_KEY),this.removeFromRoamingSettings(this.STORAGE_KEYS.SELECTED_MODEL),this.removeFromRoamingSettings(this.STORAGE_KEYS.LAST_UPDATED),this.removeFromLocalStorage(this.STORAGE_KEYS.API_KEY),await this.saveRoamingSettingsAsync()}catch(e){throw console.error("Error clearing settings:",e),new Error("Failed to clear settings")}}async hasApiKey(){return(await this.getSettings()).apiKey.trim().length>0}getFromLocalStorage(e){try{return localStorage.getItem(e)}catch(t){return console.error(`Error reading from localStorage (${e}):`,t),null}}removeFromLocalStorage(e){try{localStorage.removeItem(e)}catch(t){console.error(`Error removing from localStorage (${e}):`,t)}}getFromRoamingSettings(e){if(p())try{return Office.context.roamingSettings.get(e)}catch(t){return console.error(`Error reading from roaming settings (${e}):`,t),null}try{const t=localStorage.getItem(d+e);return t?JSON.parse(t):null}catch{return null}}saveToRoamingSettings(e,t){if(p())try{Office.context.roamingSettings.set(e,t)}catch(t){throw console.error(`Error writing to roaming settings (${e}):`,t),t}else try{localStorage.setItem(d+e,JSON.stringify(t))}catch(t){console.error(`Error writing to localStorage fallback (${e}):`,t)}}removeFromRoamingSettings(e){if(p())try{Office.context.roamingSettings.remove(e)}catch(t){console.error(`Error removing from roaming settings (${e}):`,t)}else try{localStorage.removeItem(d+e)}catch{}}saveRoamingSettingsAsync(){return p()?new Promise((e,t)=>{try{Office.context.roamingSettings.saveAsync(r=>{r.status===Office.AsyncResultStatus.Succeeded?e():t(new Error(`Failed to save roaming settings: ${r.error?.message}`))})}catch(e){t(e)}}):Promise.resolve()}}const m=()=>{const[e,t]=(0,n.useState)({apiKey:"",selectedModel:"gpt-5.2",lastUpdated:(new Date).toISOString()}),[r,o]=(0,n.useState)(!0),[s,a]=(0,n.useState)(null),[i]=(0,n.useState)(()=>new g);(0,n.useEffect)(()=>{(async()=>{try{o(!0),a(null);const e=await i.getSettings();t(e)}catch(e){a("Failed to load settings"),console.error("Error loading settings:",e)}finally{o(!1)}})()},[i]);const c=(0,n.useCallback)(async r=>{try{a(null);const n={...e,...r,lastUpdated:(new Date).toISOString()};await i.saveSettings(n),t(n)}catch(e){throw a("Failed to save settings"),console.error("Error saving settings:",e),e}},[e,i]),l=(0,n.useCallback)(async()=>{try{a(null),await i.clearSettings();const e=await i.getSettings();t(e)}catch(e){throw a("Failed to reset settings"),console.error("Error resetting settings:",e),e}},[i]),d=e.apiKey.trim().length>0;return{settings:e,isLoading:r,error:s,updateSettings:c,resetSettings:l,hasApiKey:d}}}}]);