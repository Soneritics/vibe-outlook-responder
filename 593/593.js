"use strict";(self.webpackChunkoutlook_ai_assistant=self.webpackChunkoutlook_ai_assistant||[]).push([[593],{1593(e,t,n){n.a(e,async(e,a)=>{try{n.d(t,{GenerateScreen:()=>C});var r=n(4848),i=n(6540),o=n(4867),s=n(6117),l=n(8610),c=n(6922),p=n(6760),d=n(813),g=n(9437),m=n(4541),u=n(2558),x=n(378),h=n(272),y=n(8005),f=n(269),j=n(2784),L=n(444),N=n(9059),S=n(6394),k=e([L]),b=k.then?(await k)():k;L=b[0];const v=(0,m.n)({container:{display:"flex",flexDirection:"column",height:"100%",...o.Pt.padding(u.L.spacingVerticalL,u.L.spacingHorizontalL)},header:{marginBottom:u.L.spacingVerticalL},title:{fontSize:u.L.fontSizeBase500,fontWeight:u.L.fontWeightSemibold,color:u.L.colorNeutralForeground1},subtitle:{fontSize:u.L.fontSizeBase300,color:u.L.colorNeutralForeground3,marginTop:u.L.spacingVerticalXS},promptList:{display:"flex",flexDirection:"column",...o.Pt.gap(u.L.spacingVerticalS),flexGrow:1,overflowY:"auto"},promptItem:{display:"flex",alignItems:"center",justifyContent:"space-between",...o.Pt.padding(u.L.spacingVerticalM,u.L.spacingHorizontalM),...o.Pt.borderRadius(u.L.borderRadiusMedium),backgroundColor:u.L.colorNeutralBackground2,cursor:"pointer",":hover":{backgroundColor:u.L.colorNeutralBackground2Hover}},promptTitle:{fontSize:u.L.fontSizeBase300,fontWeight:u.L.fontWeightSemibold,color:u.L.colorNeutralForeground1},emptyState:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flexGrow:1,textAlign:"center",...o.Pt.gap(u.L.spacingVerticalM)},emptyText:{color:u.L.colorNeutralForeground3},footer:{marginTop:u.L.spacingVerticalL,display:"flex",...o.Pt.gap(u.L.spacingHorizontalM)},loading:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"}}),C=({onOpenSettings:e,onAddPrompt:t})=>{const n=v(),{prompts:a,loading:o}=(0,f.F)(),{settings:m,isLoading:u}=(0,j.t)(),{isGenerating:k,currentStep:b,error:C,generate:w,cancel:P,clearError:I}=(0,L.A)(),[z,A]=(0,i.useState)(null),V=async e=>{m?.apiKey&&(A(e),await w(e.content,m.apiKey,m.selectedModel||"gpt-4"))};return o||u?(0,r.jsx)("div",{className:n.loading,children:(0,r.jsx)(s.y,{label:"Loading..."})}):m?.apiKey?(0,r.jsxs)("div",{className:n.container,children:[(0,r.jsxs)("div",{className:n.header,children:[(0,r.jsx)(g.E,{className:n.title,children:"AI Reply"}),(0,r.jsx)(g.E,{className:n.subtitle,children:"Select a prompt to generate an AI-powered response"})]}),C&&(0,r.jsx)(S.F,{message:C,onRetry:async()=>{z&&m?.apiKey&&(I(),await w(z.content,m.apiKey,m.selectedModel||"gpt-4"))},onDismiss:I}),0===a.length?(0,r.jsxs)("div",{className:n.emptyState,children:[(0,r.jsx)(g.E,{className:n.emptyText,children:"No prompts available. Create a prompt to get started."}),t&&(0,r.jsx)(d.$,{appearance:"primary",icon:(0,r.jsx)(h.wYX,{}),onClick:t,children:"Create Prompt"})]}):(0,r.jsx)("div",{className:n.promptList,children:a.map(e=>(0,r.jsxs)("div",{className:n.promptItem,onClick:()=>V(e),role:"button",tabIndex:0,onKeyDown:t=>{"Enter"!==t.key&&" "!==t.key||V(e)},children:[(0,r.jsx)(g.E,{className:n.promptTitle,children:e.title}),(0,r.jsx)(y.D6j,{})]},e.id))}),a.length>0&&t&&(0,r.jsx)("div",{className:n.footer,children:(0,r.jsx)(d.$,{appearance:"secondary",icon:(0,r.jsx)(h.wYX,{}),onClick:t,children:"Add Prompt"})}),(0,r.jsx)(N.v,{isOpen:k,currentStep:b,onCancel:P,error:C||void 0})]}):(0,r.jsxs)("div",{className:n.container,children:[(0,r.jsx)(l.n,{intent:"warning",children:(0,r.jsxs)(c.R,{children:[(0,r.jsx)(p.V,{children:"API Key Required"}),"Please configure your ChatGPT API key in settings before generating responses."]})}),e&&(0,r.jsx)("div",{className:n.footer,children:(0,r.jsx)(d.$,{appearance:"primary",icon:(0,r.jsx)(x.mJc,{}),onClick:e,children:"Open Settings"})})]})};a()}catch(e){a(e)}})}}]);