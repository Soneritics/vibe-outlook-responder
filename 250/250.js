"use strict";(self.webpackChunkvibe_outlook_responder=self.webpackChunkvibe_outlook_responder||[]).push([[250],{5951(e,t,s){s.d(t,{T:()=>g});var o=s(4848),r=s(2784),a=s(1439),n=s(4938),i=s(8130),c=s(9265),l=s(7395),d=s(9563),p=s(813);const g=({open:e,title:t,message:s,confirmLabel:g="Confirm",cancelLabel:m="Cancel",onConfirm:u,onCancel:h,destructive:S=!1})=>(0,o.jsx)(r.l,{open:e,onOpenChange:(e,t)=>!t.open&&h(),children:(0,o.jsx)(a.E,{children:(0,o.jsxs)(n.R,{children:[(0,o.jsx)(i.L,{children:t}),(0,o.jsx)(c.C,{children:s}),(0,o.jsxs)(l.i,{children:[(0,o.jsx)(d.z,{disableButtonEnhancement:!0,children:(0,o.jsx)(p.$,{appearance:"secondary",onClick:h,children:m})}),(0,o.jsx)(p.$,{appearance:"primary",onClick:u,children:g})]})]})})})},4250(e,t,s){s.d(t,{SettingsPanel:()=>$});var o=s(4848),r=s(6540),a=s(4541),n=s(2558),i=s(6117),c=s(6516),l=s(9437),d=s(9105),p=s(813),g=s(8490),m=s(8551),u=s(3616),h=s(2471),S=s(2534);const y=(0,a.n)({container:{display:"flex",flexDirection:"column",gap:n.L.spacingVerticalS},inputWrapper:{display:"flex",gap:n.L.spacingHorizontalS,alignItems:"flex-start"},input:{flexGrow:1},buttonGroup:{display:"flex",gap:n.L.spacingHorizontalXS},successMessage:{color:n.L.colorPaletteGreenForeground1,fontSize:n.L.fontSizeBase200},errorMessage:{color:n.L.colorPaletteRedForeground1,fontSize:n.L.fontSizeBase200}}),x=({value:e,onChange:t,onTestConnection:s,error:a,isTestingConnection:n=!1,testConnectionResult:c})=>{const l=y(),[d,g]=(0,r.useState)(!1),m=!e||0===e.trim().length;return(0,o.jsxs)("div",{className:l.container,children:[(0,o.jsx)(u.D,{label:"API Key",validationMessage:a,validationState:a?"error":void 0,children:(0,o.jsxs)("div",{className:l.inputWrapper,children:[(0,o.jsx)(h.p,{type:d?"text":"password",value:e,onChange:e=>{t(e.target.value)},placeholder:"sk-...",className:l.input,"aria-label":"API Key","aria-invalid":!!a}),(0,o.jsxs)("div",{className:l.buttonGroup,children:[(0,o.jsx)(p.$,{appearance:"subtle",icon:d?(0,o.jsx)(S.nat,{}):(0,o.jsx)(S.umr,{}),onClick:()=>{g(!d)},"aria-label":d?"Hide API key":"Show API key",title:d?"Hide":"Show"}),(0,o.jsx)(p.$,{appearance:"primary",onClick:s,disabled:m||n,"aria-label":"Test Connection",children:n?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(i.y,{size:"tiny"})," Testing..."]}):"Test Connection"})]})]})}),c&&(0,o.jsx)("div",{className:c.success?l.successMessage:l.errorMessage,role:"alert",children:c.message})]})};var f=s(4429),v=s(3879);const E=(0,a.n)({container:{display:"flex",flexDirection:"column",gap:n.L.spacingVerticalXS},description:{fontSize:n.L.fontSizeBase200,color:n.L.colorNeutralForeground2,marginTop:n.L.spacingVerticalXXS},optionContent:{display:"flex",flexDirection:"column",gap:n.L.spacingVerticalXXS},optionTitle:{fontWeight:n.L.fontWeightSemibold},optionDescription:{fontSize:n.L.fontSizeBase200,color:n.L.colorNeutralForeground2}}),b=[{id:"gpt-4o",name:"GPT-4o (Default)",description:"Latest and most capable model with enhanced reasoning",contextWindow:"128K tokens"},{id:"gpt-4-turbo",name:"GPT-4 Turbo",description:"Faster and more affordable with excellent performance",contextWindow:"128K tokens"},{id:"gpt-4",name:"GPT-4",description:"High-quality responses with strong reasoning",contextWindow:"8K tokens"},{id:"gpt-3.5-turbo",name:"GPT-3.5 Turbo",description:"Fast and cost-effective for simpler tasks",contextWindow:"16K tokens"}],j=({value:e,onChange:t,disabled:s=!1})=>{const r=E(),a=e||"gpt-4o",n=b.find(e=>e.id===a);return(0,o.jsxs)("div",{className:r.container,children:[(0,o.jsx)(u.D,{label:"Model",children:(0,o.jsx)(f.m,{value:n?.name||"",selectedOptions:[a],onOptionSelect:(e,s)=>{s.optionValue&&t(s.optionValue)},disabled:s,"aria-label":"Select ChatGPT model",children:b.map(e=>(0,o.jsx)(v.c,{value:e.id,text:e.name,children:(0,o.jsxs)("div",{className:r.optionContent,children:[(0,o.jsx)(l.E,{className:r.optionTitle,children:e.name}),(0,o.jsxs)(l.E,{className:r.optionDescription,children:[e.description," • ",e.contextWindow]})]})},e.id))})}),n&&(0,o.jsxs)(l.E,{className:r.description,children:[n.description," • Context: ",n.contextWindow]})]})};var w=s(2889),L=s(7575),T=s(5399),k=s(8515);const A=(0,a.n)({container:{display:"flex",flexDirection:"column",gap:n.L.spacingVerticalM},card:{padding:n.L.spacingHorizontalM},shortcutRow:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:`${n.L.spacingVerticalS} 0`},shortcutLabel:{flex:1},shortcutKey:{fontFamily:"monospace",padding:`${n.L.spacingVerticalXS} ${n.L.spacingHorizontalS}`,backgroundColor:n.L.colorNeutralBackground2,borderRadius:n.L.borderRadiusMedium,border:`1px solid ${n.L.colorNeutralStroke1}`},description:{color:n.L.colorNeutralForeground3,marginBottom:n.L.spacingVerticalM}}),C=({shortcuts:e={}})=>{const t=A(),s=[{action:"Open Prompt Dropdown",keys:e.openPromptDropdown||"Not configured",description:"Quick access to prompt selection"},{action:"Focus Settings",keys:e.openSettings||"Alt + S",description:"Open settings panel"}];return(0,o.jsxs)("div",{className:t.container,children:[(0,o.jsxs)(w.J,{size:"large",children:[(0,o.jsx)(k.ynU,{})," Keyboard Shortcuts"]}),(0,o.jsx)(l.E,{className:t.description,children:"Keyboard shortcuts for quick access to common actions. Office Add-ins have limited keyboard shortcut customization support."}),(0,o.jsxs)(L.Z,{className:t.card,children:[(0,o.jsx)(T.a,{header:(0,o.jsx)(l.E,{weight:"semibold",children:"Available Shortcuts"})}),s.map((e,s)=>(0,o.jsxs)("div",{className:t.shortcutRow,children:[(0,o.jsxs)("div",{className:t.shortcutLabel,children:[(0,o.jsx)(l.E,{children:e.action}),(0,o.jsx)(l.E,{size:200,className:t.description,children:e.description})]}),(0,o.jsx)(l.E,{className:t.shortcutKey,children:e.keys})]},s))]}),(0,o.jsx)(l.E,{size:200,className:t.description,children:"Note: Keyboard shortcuts in Office Add-ins are platform-specific and may not work in all environments (Desktop, Web, Mobile)."})]})};var N=s(8005),I=s(4826),O=s(6014);const R=(0,a.n)({container:{display:"flex",flexDirection:"column",gap:n.L.spacingVerticalM},card:{padding:n.L.spacingHorizontalM},buttonGroup:{display:"flex",gap:n.L.spacingHorizontalS,marginTop:n.L.spacingVerticalM},message:{display:"flex",alignItems:"center",gap:n.L.spacingHorizontalS,marginTop:n.L.spacingVerticalS},successMessage:{color:n.L.colorPaletteGreenForeground1},errorMessage:{color:n.L.colorPaletteRedForeground1},description:{color:n.L.colorNeutralForeground3,marginBottom:n.L.spacingVerticalS}}),D=({prompts:e,onImport:t})=>{const s=R(),[a,n]=(0,r.useState)(null),[i,c]=(0,r.useState)(!1),[d,g]=(0,r.useState)(!1);return(0,o.jsxs)("div",{className:s.container,children:[(0,o.jsx)(w.J,{size:"large",children:"Export/Import Prompts"}),(0,o.jsx)(l.E,{className:s.description,children:"Backup your prompts by exporting to clipboard, or restore from a previous export."}),(0,o.jsxs)(L.Z,{className:s.card,children:[(0,o.jsx)(T.a,{header:(0,o.jsx)(l.E,{weight:"semibold",children:"Backup & Restore"}),description:(0,o.jsx)(l.E,{size:200,children:"Prompts are saved as JSON format. Import will merge with existing prompts."})}),(0,o.jsxs)("div",{className:s.buttonGroup,children:[(0,o.jsx)(p.$,{appearance:"secondary",icon:(0,o.jsx)(N.W1u,{}),onClick:async()=>{c(!0),n(null);try{const t=JSON.stringify(e,null,2);await async function(e){try{if(void 0!==navigator.clipboard&&void 0!==navigator.clipboard.writeText)await navigator.clipboard.writeText(e);else{const t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.left="-999999px",document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}}catch(e){throw new Error("Failed to copy to clipboard")}}(t),n({type:"success",text:`Successfully exported ${e.length} prompt(s) to clipboard`})}catch(e){n({type:"error",text:`Export failed: ${e instanceof Error?e.message:"Unknown error"}`})}finally{c(!1),setTimeout(()=>n(null),5e3)}},disabled:i||0===e.length,children:i?"Exporting...":"Export to Clipboard"}),(0,o.jsx)(p.$,{appearance:"secondary",icon:(0,o.jsx)(N.Do$,{}),onClick:async()=>{g(!0),n(null);try{const s=await async function(){try{if(void 0!==navigator.clipboard&&void 0!==navigator.clipboard.readText)return await navigator.clipboard.readText();throw new Error("Clipboard API not available in this browser")}catch(e){throw new Error("Failed to read from clipboard")}}();if(!s)return void n({type:"error",text:"Clipboard is empty. Please copy valid JSON first."});let o;try{o=JSON.parse(s)}catch(e){return void n({type:"error",text:"Invalid JSON format. Please check clipboard content."})}if(!Array.isArray(o))return void n({type:"error",text:"Invalid format: Expected an array of prompts."});if(!o.every(e=>e&&"string"==typeof e.title&&"string"==typeof e.content))return void n({type:"error",text:"Invalid prompt structure. Each prompt must have title and content."});const r=new Set(e.map(e=>e.title.toLowerCase())),a=o.map(e=>{let t=e.title;if(r.has(t.toLowerCase())){t=`${t} (imported)`;let s=1;for(;r.has(t.toLowerCase());)t=`${e.title} (imported ${s})`,s++}return{...e,title:t,id:`${Date.now()}_${Math.random().toString(36).substring(2,9)}`,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()}});await t(a),n({type:"success",text:`Successfully imported ${a.length} prompt(s)`})}catch(e){n({type:"error",text:`Import failed: ${e instanceof Error?e.message:"Unknown error"}`})}finally{g(!1),setTimeout(()=>n(null),5e3)}},disabled:d,children:d?"Importing...":"Import from Clipboard"})]}),a&&(0,o.jsxs)("div",{className:`${s.message} ${"success"===a.type?s.successMessage:s.errorMessage}`,role:"alert",children:["success"===a.type?(0,o.jsx)(I.kt0,{}):(0,o.jsx)(O.Pe6,{}),(0,o.jsx)(l.E,{children:a.text})]})]}),(0,o.jsx)(l.E,{size:200,className:s.description,children:'Note: Exported prompts include all content and metadata. Import will preserve your existing prompts and append any duplicates with "(imported)".'})]})};var P=s(3644),_=s(269);const F='API key must start with "sk-" and be at least 20 characters';function K(e){return e&&0!==e.trim().length?e.startsWith("sk-")?e.length<20?{isValid:!1,error:F}:{isValid:!0}:{isValid:!1,error:F}:{isValid:!1,error:"API key is required"}}var M=s(5951);const G=(0,a.n)({container:{display:"flex",flexDirection:"column",gap:n.L.spacingVerticalL,padding:n.L.spacingHorizontalL,height:"100%",overflow:"auto"},header:{display:"flex",flexDirection:"column",gap:n.L.spacingVerticalXS},section:{display:"flex",flexDirection:"column",gap:n.L.spacingVerticalM},buttonGroup:{display:"flex",gap:n.L.spacingHorizontalS,marginTop:n.L.spacingVerticalM},errorMessage:{color:n.L.colorPaletteRedForeground1,fontSize:n.L.fontSizeBase200},successMessage:{color:n.L.colorPaletteGreenForeground1,fontSize:n.L.fontSizeBase200},loadingContainer:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},dangerZone:{marginTop:n.L.spacingVerticalL,paddingTop:n.L.spacingVerticalL}}),$=()=>{const e=G(),{settings:t,isLoading:s,updateSettings:a,resetSettings:u}=(0,P.t)(),{prompts:h,createPrompt:S,deletePrompt:y}=(0,_.F)(),[f,v]=(0,r.useState)(""),[E,b]=(0,r.useState)(""),[w,L]=(0,r.useState)(""),[T,k]=(0,r.useState)(!1),[A,N]=(0,r.useState)(void 0),[I,O]=(0,r.useState)(!1),[R,F]=(0,r.useState)(""),[$,z]=(0,r.useState)(!1);r.useEffect(()=>{s||(v(t.apiKey),b(t.selectedModel))},[t,s]);const V=(0,r.useCallback)(async()=>{k(!0),N(void 0),L("");try{const e=K(f);if(!e.isValid)return L(e.error||"Invalid API key format"),void N({success:!1,message:'Invalid API key format. Must start with "sk-"'});const t=await fetch("https://api.openai.com/v1/models",{method:"GET",headers:{Authorization:`Bearer ${f}`}});t.ok?N({success:!0,message:"Connection successful! Your API key is valid."}):401===t.status?N({success:!1,message:"Invalid or expired API key. Please check your key."}):N({success:!1,message:`Connection failed with status ${t.status}. Please try again.`})}catch(e){N({success:!1,message:"Network error. Please check your connection and try again."})}finally{k(!1)}},[f]);return s?(0,o.jsx)("div",{className:e.loadingContainer,children:(0,o.jsx)(i.y,{size:"large",label:"Loading settings..."})}):(0,o.jsxs)("div",{className:e.container,children:[(0,o.jsxs)("div",{className:e.header,children:[(0,o.jsx)(c.M,{children:"Settings"}),(0,o.jsx)(l.E,{children:"Configure your ChatGPT API key and model preferences"})]}),(0,o.jsx)(d.c,{}),(0,o.jsxs)("div",{className:e.section,children:[(0,o.jsx)(x,{value:f,onChange:e=>{v(e),L(""),N(void 0),F("")},onTestConnection:V,error:w,isTestingConnection:T,testConnectionResult:A}),(0,o.jsx)(j,{value:E,onChange:e=>{b(e),F("")},disabled:I})]}),(0,o.jsx)(d.c,{}),(0,o.jsx)("div",{className:e.section,children:(0,o.jsx)(C,{shortcuts:t.keyboardShortcuts})}),(0,o.jsx)(d.c,{}),(0,o.jsx)("div",{className:e.section,children:(0,o.jsx)(D,{prompts:h,onImport:async e=>{try{for(const t of e)await S({title:t.title,content:t.content})}catch(e){throw new Error("Failed to import prompts")}}})}),(0,o.jsx)("div",{className:e.buttonGroup,children:(0,o.jsx)(p.$,{appearance:"primary",icon:(0,o.jsx)(g.osE,{}),onClick:async()=>{O(!0),F(""),L("");try{if(f.trim()){const e=K(f);if(!e.isValid)return L(e.error||"Invalid API key format"),void O(!1)}await a({apiKey:f,selectedModel:E}),F("Settings saved successfully!"),setTimeout(()=>F(""),3e3)}catch(e){F("Failed to save settings. Please try again.")}finally{O(!1)}},disabled:I,children:I?"Saving...":"Save Settings"})}),R&&(0,o.jsx)(l.E,{className:R.includes("success")?e.successMessage:e.errorMessage,role:"alert",children:R}),(0,o.jsxs)("div",{className:e.dangerZone,children:[(0,o.jsx)(d.c,{}),(0,o.jsx)(c.M,{children:"Danger Zone"}),(0,o.jsx)(l.E,{children:"Reset all settings and delete all prompts. This action cannot be undone."}),(0,o.jsx)(p.$,{appearance:"subtle",icon:(0,o.jsx)(m.aYy,{}),onClick:()=>z(!0),style:{marginTop:n.L.spacingVerticalS},children:"Reset All Data"})]}),(0,o.jsx)(M.T,{open:$,title:"Reset All Data?",message:"This will clear your API key, model preference, all prompts, and all other settings. This action cannot be undone.",confirmLabel:"Reset",cancelLabel:"Cancel",onConfirm:async()=>{try{await u();for(const e of h)await y(e.id);v(""),b("gpt-4o"),L(""),N(void 0),F("All settings and prompts have been reset."),z(!1)}catch(e){F("Failed to reset settings. Please try again.")}},onCancel:()=>z(!1)})]})}},3644(e,t,s){s.d(t,{t:()=>i});var o=s(6540);const r="outlook_addin_roaming_";function a(){return"undefined"!=typeof Office&&void 0!==Office.context&&void 0!==Office.context.roamingSettings}class n{STORAGE_KEYS={API_KEY:"settings_apiKey",SELECTED_MODEL:"settings_selectedModel",KEYBOARD_SHORTCUTS:"settings_keyboardShortcuts",LAST_UPDATED:"settings_lastUpdated"};DEFAULT_SETTINGS={apiKey:"",selectedModel:"gpt-4o",keyboardShortcuts:{},lastUpdated:(new Date).toISOString()};async getSettings(){try{const e=this.getFromLocalStorage(this.STORAGE_KEYS.API_KEY)||"",t=this.getFromRoamingSettings(this.STORAGE_KEYS.SELECTED_MODEL)||this.DEFAULT_SETTINGS.selectedModel;return{apiKey:e,selectedModel:t,keyboardShortcuts:this.getFromRoamingSettings(this.STORAGE_KEYS.KEYBOARD_SHORTCUTS)||{},lastUpdated:this.getFromRoamingSettings(this.STORAGE_KEYS.LAST_UPDATED)||this.DEFAULT_SETTINGS.lastUpdated}}catch(e){return console.error("Error loading settings:",e),{...this.DEFAULT_SETTINGS}}}async saveSettings(e){try{this.saveToLocalStorage(this.STORAGE_KEYS.API_KEY,e.apiKey),this.saveToRoamingSettings(this.STORAGE_KEYS.SELECTED_MODEL,e.selectedModel),this.saveToRoamingSettings(this.STORAGE_KEYS.KEYBOARD_SHORTCUTS,e.keyboardShortcuts);const t=(new Date).toISOString();this.saveToRoamingSettings(this.STORAGE_KEYS.LAST_UPDATED,t),await this.saveRoamingSettingsAsync()}catch(e){throw console.error("Error saving settings:",e),new Error("Failed to save settings")}}async clearSettings(){try{this.removeFromLocalStorage(this.STORAGE_KEYS.API_KEY),this.removeFromRoamingSettings(this.STORAGE_KEYS.SELECTED_MODEL),this.removeFromRoamingSettings(this.STORAGE_KEYS.KEYBOARD_SHORTCUTS),this.removeFromRoamingSettings(this.STORAGE_KEYS.LAST_UPDATED),await this.saveRoamingSettingsAsync()}catch(e){throw console.error("Error clearing settings:",e),new Error("Failed to clear settings")}}async hasApiKey(){return(await this.getSettings()).apiKey.trim().length>0}getFromLocalStorage(e){try{return localStorage.getItem(e)}catch(t){return console.error(`Error reading from localStorage (${e}):`,t),null}}saveToLocalStorage(e,t){try{localStorage.setItem(e,t)}catch(t){throw console.error(`Error writing to localStorage (${e}):`,t),t}}removeFromLocalStorage(e){try{localStorage.removeItem(e)}catch(t){console.error(`Error removing from localStorage (${e}):`,t)}}getFromRoamingSettings(e){if(a())try{return Office.context.roamingSettings.get(e)}catch(t){return console.error(`Error reading from roaming settings (${e}):`,t),null}try{const t=localStorage.getItem(r+e);return t?JSON.parse(t):null}catch{return null}}saveToRoamingSettings(e,t){if(a())try{Office.context.roamingSettings.set(e,t)}catch(t){throw console.error(`Error writing to roaming settings (${e}):`,t),t}else try{localStorage.setItem(r+e,JSON.stringify(t))}catch(t){console.error(`Error writing to localStorage fallback (${e}):`,t)}}removeFromRoamingSettings(e){if(a())try{Office.context.roamingSettings.remove(e)}catch(t){console.error(`Error removing from roaming settings (${e}):`,t)}else try{localStorage.removeItem(r+e)}catch{}}saveRoamingSettingsAsync(){return a()?new Promise((e,t)=>{try{Office.context.roamingSettings.saveAsync(s=>{s.status===Office.AsyncResultStatus.Succeeded?e():t(new Error(`Failed to save roaming settings: ${s.error?.message}`))})}catch(e){t(e)}}):Promise.resolve()}}const i=()=>{const[e,t]=(0,o.useState)({apiKey:"",selectedModel:"gpt-4o",keyboardShortcuts:{},lastUpdated:(new Date).toISOString()}),[s,r]=(0,o.useState)(!0),[a,i]=(0,o.useState)(null),[c]=(0,o.useState)(()=>new n);(0,o.useEffect)(()=>{(async()=>{try{r(!0),i(null);const e=await c.getSettings();t(e)}catch(e){i("Failed to load settings"),console.error("Error loading settings:",e)}finally{r(!1)}})()},[c]);const l=(0,o.useCallback)(async s=>{try{i(null);const o={...e,...s,lastUpdated:(new Date).toISOString()};await c.saveSettings(o),t(o)}catch(e){throw i("Failed to save settings"),console.error("Error saving settings:",e),e}},[e,c]),d=(0,o.useCallback)(async()=>{try{i(null),await c.clearSettings();const e=await c.getSettings();t(e)}catch(e){throw i("Failed to reset settings"),console.error("Error resetting settings:",e),e}},[c]),p=e.apiKey.trim().length>0;return{settings:e,isLoading:s,error:a,updateSettings:l,resetSettings:d,hasApiKey:p}}}}]);